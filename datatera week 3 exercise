DATABASE ua_dillards;

SELECT str.state, str.city, sku.dept, sum(t.amt) as Total_Sales
FROM strinfo STR, skuinfo sku, trnsact t WHERE t.store=str.store AND t.sku= sku.sku
GROUP By str.state, str.city,sku.dept
ORDER by str.state, str.city, sku.dept;
DATABASE ua_dillards;
HELP TABLE TRNSACT;
HELP COLUMN TRANNUM;
SHOW TABLE TRNSACT;
SHOW TABLE DEPTINFO;
SHOW TABLE SKSTINFO;
SHOW TABLE SKSTINFO_FIX;
SHOW TABLE SKUINFO;
SHOW TABLE STORE_MSA;
SHOW TABLE STRINFO;
DATABASE ua_dillards;

HELP TABLE TRNSACT;

SELECT TOP 6 SALEDATE FROM TRNSACT
WHERE SALEDATE < '2005-04-07'
ORDER BY SALEDATE DESC;
DATABASE ua_dillards;

HELP TABLE TRNSACT;

SELECT TOP 6 SALEDATE FROM TRNSACT
WHERE SALEDATE < '2005-04-07'
ORDER BY SALEDATE DESC;
DATABASE ua_dillards;

HELP TABLE TRNSACT;

SELECT TOP 6 SALEDATE FROM TRNSACT
WHERE SALEDATE < '2005-04-07'
ORDER BY SALEDATE DESC;

SELECT TOP 1 * FROM TRNSACT;

SELECT * FROM TRNSACT SAMPLE 10;

SELECT * FROM TRNSACT SAMPLE .10;

SELECT  DISTINCT DEPT, COLOR FROM SKUINFO;

SELECT TOP 100 * FROM TRNSACT;
SELECT SALEDATE, AMT, SPRICE, QUANTITY FROM TRNSACT WHERE AMT <> SPRICE;

SELECT TOP 1 * FROM TRNSACT;
SELECT SALEDATE, ORGPRICE FROM TRNSACT WHERE ORGPRICE = '0';
SELECT TOP 1 * FROM SKSTINFO;
SELECT COST, RETAIL, SKU FROM SKSTINFO WHERE COST ='0' AND RETAIL = '0';
SELECT COST, RETAIL, SKU FROM SKSTINFO WHERE COST >= RETAIL;

SELECT SALEDATE, QUANTITY REGISTER FROM TRNSACT WHERE SALEDATE BETWEEN '2004-10-01' AND '2005-05-01' AND STYPE = 'P' ORDER BY SALEDATE DESC;
DATABASE ua_dillards;

HELP TABLE TRNSACT;

SELECT TOP 6 SALEDATE FROM TRNSACT
WHERE SALEDATE < '2005-04-07'
ORDER BY SALEDATE DESC;

SELECT TOP 1 * FROM TRNSACT;

SELECT * FROM TRNSACT SAMPLE 10;

SELECT * FROM TRNSACT SAMPLE .10;

SELECT  DISTINCT DEPT, COLOR FROM SKUINFO;

SELECT TOP 100 * FROM TRNSACT;
SELECT SALEDATE, AMT, SPRICE, QUANTITY FROM TRNSACT WHERE AMT <> SPRICE;

SELECT TOP 1 * FROM TRNSACT;
SELECT SALEDATE, ORGPRICE FROM TRNSACT WHERE ORGPRICE = '0';
SELECT TOP 1 * FROM SKSTINFO;
SELECT COST, RETAIL, SKU FROM SKSTINFO WHERE COST ='0' AND RETAIL = '0';
SELECT COST, RETAIL, SKU FROM SKSTINFO WHERE COST >= RETAIL;

SELECT SALEDATE, QUANTITY REGISTER FROM TRNSACT WHERE SALEDATE BETWEEN '2004-10-01' AND '2005-05-01' AND STYPE = 'P' ORDER BY SALEDATE DESC;


HELP TABLE STRINFO;
SHOW TABLE STRINFO;

SELECT TOP 2 ORGPRICE FROM TRNSACT WHERE SKU ='3631365' ORDER BY ORGPRICE DESC;

SELECT TOP 1 * FROM SKUINFO;
SELECT COLOR, BRAND, SKU FROM SKUINFO WHERE BRAND='LIZ CLAI' ORDER BY SKU DESC;

SELECT TOP 2 ORGPRICE, SKU FROM TRNSACT ORDER BY ORGPRICE DESC;

SELECT TOP 1 * FROM STRINFO;
SELECT DISTINCT STATE FROM STRINFO;

SELECT TOP 1 * FROM DEPTINFO;
SELECT DEPT, DEPTDESC FROM DEPTINFO WHERE DEPTDESC LIKE 'e%';


SELECT SALEDATE, ORGPRICE, SPRICE, ORGPRICE-SPRICE AS MARGIN FROM TRNSACT WHERE ORGPRICE <>SPRICE ORDER BY SALEDATE ASC, MARGIN DESC;

SELECT REGISTER,ORGPRICE, SPRICE FROM TRNSACT WHERE SALEDATE BETWEEN '2004-08-01' AND '2004-08-10' ORDER BY ORGPRICE DESC, SPRICE DESC;

SELECT DISTINCT BRAND FROM SKUINFO WHERE BRAND LIKE '%LIZ%';

SELECT TOP 1 * FROM STORE_MSA;
SELECT STORE, CITY FROM STORE_MSA WHERE CITY = 'LITTLE ROCK' OR CITY = 'MEMPHIS' OR CITY = 'TULSA' ORDER BY STORE ASC
DATABASE UA_DILLARDS
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, SKSTINFO t WHERE u.SKU=t.SKU;
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, TRNSACT c WHERE u.SKU=c.SKU;
SELECT COUNT(DISTINCT t.SKU) AS num FROM TRNSACT c, SKSTINFO t WHERE c.SKU=t.SKU;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN TRNSACT c ON u.SKU=c.SKU WHERE u.SKU IS NOT NULL AND c.SKU IS NULL;
SELECT DISTINCT(t.SKU) AS uni FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT COUNT(*) AS times, t.SKU, t.STORE FROM SKSTINFO t, TRNSACT c WHERE t.SKU=c.SKU AND t.STORE=c.STORE GROUP BY t.STORE, t.SKU;

SELECT COUNT(DISTINCT STORE) AS num FROM STRINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM STORE_MSA;
SELECT COUNT(DISTINCT STORE) AS num FROM SKSTINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM TRNSACT;



SELECT s.STORE AS uni FROM ((STRINFO s LEFT JOIN STORE_MSA m ON s.STORE=m.STORE) LEFT JOIN SKSTINFO t ON m.STORE=t.STORE) LEFT JOIN TRNSACT c ON t.STORE=c.STORE WHERE s.STORE IS NOT NULL AND c.STORE IS NULL AND m.STORE IS NULL AND t.STORE IS NULL;

SELECT DISTINCT(c.STORE) comm FROM TRNSACT c, STORE_MSA m WHERE c.STORE=m.STORE AND c.STORE IS NOT NULL 

SELECT * FROM STORE_MSA WHERE STORE='307';
SELECT * FROM SKSTINFO WHERE STORE='307';
SELECT * FROM STRINFO WHERE STORE='307';


SELECT * FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT * FROM SKSTINFO WHERE SKU='9614895';

SELECT TOP 10(ORGPRICE/SPRICE), ORGPRICE, SPRICE AS test FROM TRNSACT; 

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P' AND REGISTER='640';



SELECT TOP 100  s.SKU FROM SKSTINFO s, TRNSACT t WHERE s.SKU=t.SKU AND s.SKU IS NOT NULL

SELECT  TOP 100 * FROM TRNSACT;
SELECT  * FROM SKSTINFO WHERE SKU='1816674';
SELECT * FROM SKUINFO WHERE SKU='1816674';


SELECT * FROM TRNSACT WHERE STYPE='R' ORDER BY AMT DESC;  (RESULT 2001-12-31)
SELECT TOP 10 * FROM TRNSACT WHERE STYPE='R' ORDER BY QUANTITY DESC; (050729, 90)

SELECT TOP 10 (AMT/QUANTITY) AS maxprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY maxprice DESC;
SELECT TOP 10 (AMT/QUANTITY) AS minprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY minprice ASC;

SELECT TOP 1 * FROM SKUINFO;
SELECT TOP 1 * FROM DEPTINFO;


SELECT COUNT(DISTINCT s.BRAND) AS num, d.DEPT, d.DEPTDESC FROM SKUINFO s, DEPTINFO d WHERE s.DEPT=d.DEPT GROUP BY d.DEPT, d.DEPTDESC HAVING COUNT(DISTINCT s.BRAND)>100;

SELECT TOP 1 * FROM SKSTINFO;           s
SELECT TOP 1 * FROM SKUINFO;            u  
SELECT TOP 1 * FROM DEPTINFO;           d

SELECT u.SKU, (d.DEPTDESC) AS Description FROM SKSTINFO s, SKUINFO u, DEPTINFO d WHERE s.SKU=u.SKU AND u.DEPT=d.DEPT AND u.SKU='5020024';

SELECT TOP 1 * FROM TRNSACT;            c

SELECT d.DEPT, d.DEPTDESC, SUM(AMT) AS maxreturn, u.BRAND, u.STYLE, u.COLOR FROM TRNSACT c, DEPTINFO d, SKUINFO u WHERE c.SKU=u.SKU AND u.DEPT=d.DEPT AND STYPE='R' GROUP BY d.DEPT, d.DEPTDESC, u.BRAND, u.STYLE, u.COLOR ORDER BY SUM(AMT) DESC;

SELECT TOP 1 * FROM STRINFO;            t

SELECT SUM(c.AMT) AS revenu, t.STORE, t.STATE, t.ZIP, t.CITY FROM TRNSACT c, STRINFO t WHERE t.STORE=c.STORE AND c.STYPE='P' GROUP BY t.STORE, t.STATE, t.ZIP, t.CITY ORDER BY SUM(c.AMT) DESC;
DATABASE UA_DILLARDS
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, SKSTINFO t WHERE u.SKU=t.SKU;
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, TRNSACT c WHERE u.SKU=c.SKU;
SELECT COUNT(DISTINCT t.SKU) AS num FROM TRNSACT c, SKSTINFO t WHERE c.SKU=t.SKU;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN TRNSACT c ON u.SKU=c.SKU WHERE u.SKU IS NOT NULL AND c.SKU IS NULL;
SELECT DISTINCT(t.SKU) AS uni FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT COUNT(*) AS times, t.SKU, t.STORE FROM SKSTINFO t, TRNSACT c WHERE t.SKU=c.SKU AND t.STORE=c.STORE GROUP BY t.STORE, t.SKU;

SELECT COUNT(DISTINCT STORE) AS num FROM STRINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM STORE_MSA;
SELECT COUNT(DISTINCT STORE) AS num FROM SKSTINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM TRNSACT;



SELECT s.STORE AS uni FROM ((STRINFO s LEFT JOIN STORE_MSA m ON s.STORE=m.STORE) LEFT JOIN SKSTINFO t ON m.STORE=t.STORE) LEFT JOIN TRNSACT c ON t.STORE=c.STORE WHERE s.STORE IS NOT NULL AND c.STORE IS NULL AND m.STORE IS NULL AND t.STORE IS NULL;

SELECT DISTINCT(c.STORE) comm FROM TRNSACT c, STORE_MSA m WHERE c.STORE=m.STORE AND c.STORE IS NOT NULL 

SELECT * FROM STORE_MSA WHERE STORE='307';
SELECT * FROM SKSTINFO WHERE STORE='307';
SELECT * FROM STRINFO WHERE STORE='307';


SELECT * FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT * FROM SKSTINFO WHERE SKU='9614895';

SELECT TOP 10(ORGPRICE/SPRICE), ORGPRICE, SPRICE AS test FROM TRNSACT; 

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P' AND REGISTER='640';



SELECT TOP 100  s.SKU FROM SKSTINFO s, TRNSACT t WHERE s.SKU=t.SKU AND s.SKU IS NOT NULL

SELECT  TOP 100 * FROM TRNSACT;
SELECT  * FROM SKSTINFO WHERE SKU='1816674';
SELECT * FROM SKUINFO WHERE SKU='1816674';


SELECT * FROM TRNSACT WHERE STYPE='R' ORDER BY AMT DESC;  (RESULT 2001-12-31)
SELECT TOP 10 * FROM TRNSACT WHERE STYPE='R' ORDER BY QUANTITY DESC; (050729, 90)

SELECT TOP 10 (AMT/QUANTITY) AS maxprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY maxprice DESC;
SELECT TOP 10 (AMT/QUANTITY) AS minprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY minprice ASC;

SELECT TOP 1 * FROM SKUINFO;
SELECT TOP 1 * FROM DEPTINFO;


SELECT COUNT(DISTINCT s.BRAND) AS num, d.DEPT, d.DEPTDESC FROM SKUINFO s, DEPTINFO d WHERE s.DEPT=d.DEPT GROUP BY d.DEPT, d.DEPTDESC HAVING COUNT(DISTINCT s.BRAND)>100;

SELECT TOP 1 * FROM SKSTINFO;           s
SELECT TOP 1 * FROM SKUINFO;            u  
SELECT TOP 1 * FROM DEPTINFO;           d

SELECT u.SKU, (d.DEPTDESC) AS Description FROM SKSTINFO s, SKUINFO u, DEPTINFO d WHERE s.SKU=u.SKU AND u.DEPT=d.DEPT AND u.SKU='5020024';

SELECT TOP 1 * FROM TRNSACT;            c

SELECT d.DEPT, d.DEPTDESC, SUM(AMT) AS maxreturn, u.BRAND, u.STYLE, u.COLOR FROM TRNSACT c, DEPTINFO d, SKUINFO u WHERE c.SKU=u.SKU AND u.DEPT=d.DEPT AND STYPE='R' GROUP BY d.DEPT, d.DEPTDESC, u.BRAND, u.STYLE, u.COLOR ORDER BY SUM(AMT) DESC;

SELECT TOP 1 * FROM STRINFO;            t

SELECT SUM(c.AMT) AS revenu, t.STORE, t.STATE, t.ZIP, t.CITY FROM TRNSACT c, STRINFO t WHERE t.STORE=c.STORE AND c.STYPE='P' GROUP BY t.STORE, t.STATE, t.ZIP, t.CITY ORDER BY SUM(c.AMT) DESC;

SELECT SUM(AMT) AS inc, SALEDATE FROM TRNSACT WHERE STYPE='P' GROUP BY SALEDATE ORDER BY SUM(AMT) DESC;

SELECT COUNT(DISTINCT u.SKU) AS num, d.DEPTDESC FROM SKUINFO u, DEPTINFO d WHERE u.DEPT=d.DEPT GROUP BY d.DEPTDESC ORDER BY COUNT(DISTINCT u.SKU) DESC

SELECT COUNT(DISTINCT SKU) as num FROM TRNSACT;
SELECT COUNT(DISTINCT SKU) as num FROM SKUINFO;
SELECT COUNT(DISTINCT SKU) as num FROM SKSTINFO

SELECT COUNT(DISTINCT s.SKU) AS num FROM SKUINFO u RIGHT JOIN SKSTINFO s ON s.SKU=u.SKU WHERE s.SKU IS NOT NULL AND u.SKU IS NULL

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P';

SELECT  * FROM STORE_MSA WHERE STATE='NC';
SELECT COUNT(MSA) AS num, MSA_POP, MSA_INCOME FROM STORE_MSA WHERE STATE='NC' GROUP BY MSA_POP, MSA_INCOME ORDER BY MSA_POP ASC, MSA_INCOME DESC;

SELECT SUM(c.AMT) AS saleamt, d.DEPT,u.BRAND, u.STYLE, u.COLOR, d.DEPTDESC FROM DEPTINFO d, TRNSACT c,  SKUINFO u WHERE u.SKU=c.SKU AND d.DEPT=u.DEPT AND STYPE='P' GROUP BY d.DEPT,u.BRAND, u.COLOR, u.STYLE, d.DEPTDESC ORDER BY SUM(c.AMT) DESC

SELECT TOP 100 * FROM SKSTINFO ORDER BY STORE ASC;
SELECT COUNT(STORE) AS num FROM SKSTINFO GROUP BY STORE HAVING COUNT(DISTINCT SKU)>180000;

SELECT DISTINCT * FROM SKUINFO u, DEPTINFO d WHERE u.DEPT=d.DEPT AND d.DEPTDESC='COP' AND u.BRAND='FEDERAL' AND u.COLOR='RINSE WASH'; 

SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT SUM(c.AMT) AS sm, t.STORE, t.CITY, t.STATE FROM TRNSACT c, STRINFO t WHERE c.STORE=t.STORE GROUP BY t.STORE, t.CITY, t.STATE ORDER BY SUM(c.AMT) DESC

SELECT COUNT(state) AS howm, STATE FROM STRINFO GROUP BY STATE  HAVING COUNT(STORE)>10

SELECT DISTINCT u.SKU, t.RETAIL, d.DEPTDESC FROM SKUINFO u, SKSTINFO t, DEPTINFO d WHERE t.SKU=u.SKU AND u.DEPT=d.DEPT AND u.BRAND='SKECHERS' AND u.COLOR='WHT/SAPHIRE' AND d.DEPTDESC='REEBOK'
DATABASE UA_DILLARDS
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, SKSTINFO t WHERE u.SKU=t.SKU;
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, TRNSACT c WHERE u.SKU=c.SKU;
SELECT COUNT(DISTINCT t.SKU) AS num FROM TRNSACT c, SKSTINFO t WHERE c.SKU=t.SKU;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN TRNSACT c ON u.SKU=c.SKU WHERE u.SKU IS NOT NULL AND c.SKU IS NULL;
SELECT DISTINCT(t.SKU) AS uni FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT COUNT(*) AS times, t.SKU, t.STORE FROM SKSTINFO t, TRNSACT c WHERE t.SKU=c.SKU AND t.STORE=c.STORE GROUP BY t.STORE, t.SKU;

SELECT COUNT(DISTINCT STORE) AS num FROM STRINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM STORE_MSA;
SELECT COUNT(DISTINCT STORE) AS num FROM SKSTINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM TRNSACT;



SELECT s.STORE AS uni FROM ((STRINFO s LEFT JOIN STORE_MSA m ON s.STORE=m.STORE) LEFT JOIN SKSTINFO t ON m.STORE=t.STORE) LEFT JOIN TRNSACT c ON t.STORE=c.STORE WHERE s.STORE IS NOT NULL AND c.STORE IS NULL AND m.STORE IS NULL AND t.STORE IS NULL;

SELECT DISTINCT(c.STORE) comm FROM TRNSACT c, STORE_MSA m WHERE c.STORE=m.STORE AND c.STORE IS NOT NULL 

SELECT * FROM STORE_MSA WHERE STORE='307';
SELECT * FROM SKSTINFO WHERE STORE='307';
SELECT * FROM STRINFO WHERE STORE='307';


SELECT * FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT * FROM SKSTINFO WHERE SKU='9614895';

SELECT TOP 10(ORGPRICE/SPRICE), ORGPRICE, SPRICE AS test FROM TRNSACT; 

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P' AND REGISTER='640';



SELECT TOP 100  s.SKU FROM SKSTINFO s, TRNSACT t WHERE s.SKU=t.SKU AND s.SKU IS NOT NULL

SELECT  TOP 100 * FROM TRNSACT;
SELECT  * FROM SKSTINFO WHERE SKU='1816674';
SELECT * FROM SKUINFO WHERE SKU='1816674';


SELECT * FROM TRNSACT WHERE STYPE='R' ORDER BY AMT DESC;  (RESULT 2001-12-31)
SELECT TOP 10 * FROM TRNSACT WHERE STYPE='R' ORDER BY QUANTITY DESC; (050729, 90)

SELECT TOP 10 (AMT/QUANTITY) AS maxprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY maxprice DESC;
SELECT TOP 10 (AMT/QUANTITY) AS minprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY minprice ASC;

SELECT TOP 1 * FROM SKUINFO;
SELECT TOP 1 * FROM DEPTINFO;


SELECT COUNT(DISTINCT s.BRAND) AS num, d.DEPT, d.DEPTDESC FROM SKUINFO s, DEPTINFO d WHERE s.DEPT=d.DEPT GROUP BY d.DEPT, d.DEPTDESC HAVING COUNT(DISTINCT s.BRAND)>100;

SELECT TOP 1 * FROM SKSTINFO;           s
SELECT TOP 1 * FROM SKUINFO;            u  
SELECT TOP 1 * FROM DEPTINFO;           d

SELECT u.SKU, (d.DEPTDESC) AS Description FROM SKSTINFO s, SKUINFO u, DEPTINFO d WHERE s.SKU=u.SKU AND u.DEPT=d.DEPT AND u.SKU='5020024';

SELECT TOP 1 * FROM TRNSACT;            c

SELECT d.DEPT, d.DEPTDESC, SUM(AMT) AS maxreturn, u.BRAND, u.STYLE, u.COLOR FROM TRNSACT c, DEPTINFO d, SKUINFO u WHERE c.SKU=u.SKU AND u.DEPT=d.DEPT AND STYPE='R' GROUP BY d.DEPT, d.DEPTDESC, u.BRAND, u.STYLE, u.COLOR ORDER BY SUM(AMT) DESC;

SELECT TOP 1 * FROM STRINFO;            t

SELECT SUM(c.AMT) AS revenu, t.STORE, t.STATE, t.ZIP, t.CITY FROM TRNSACT c, STRINFO t WHERE t.STORE=c.STORE AND c.STYPE='P' GROUP BY t.STORE, t.STATE, t.ZIP, t.CITY ORDER BY SUM(c.AMT) DESC;

SELECT SUM(AMT) AS inc, SALEDATE FROM TRNSACT WHERE STYPE='P' GROUP BY SALEDATE ORDER BY SUM(AMT) DESC;

SELECT COUNT(DISTINCT u.SKU) AS num, d.DEPTDESC FROM SKUINFO u, DEPTINFO d WHERE u.DEPT=d.DEPT GROUP BY d.DEPTDESC ORDER BY COUNT(DISTINCT u.SKU) DESC

SELECT COUNT(DISTINCT SKU) as num FROM TRNSACT;
SELECT COUNT(DISTINCT SKU) as num FROM SKUINFO;
SELECT COUNT(DISTINCT SKU) as num FROM SKSTINFO

SELECT COUNT(DISTINCT s.SKU) AS num FROM SKUINFO u RIGHT JOIN SKSTINFO s ON s.SKU=u.SKU WHERE s.SKU IS NOT NULL AND u.SKU IS NULL

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P';

SELECT  * FROM STORE_MSA WHERE STATE='NC';
SELECT COUNT(MSA) AS num, MSA_POP, MSA_INCOME FROM STORE_MSA WHERE STATE='NC' GROUP BY MSA_POP, MSA_INCOME ORDER BY MSA_POP ASC, MSA_INCOME DESC;

SELECT SUM(c.AMT) AS saleamt, d.DEPT,u.BRAND, u.STYLE, u.COLOR, d.DEPTDESC FROM DEPTINFO d, TRNSACT c,  SKUINFO u WHERE u.SKU=c.SKU AND d.DEPT=u.DEPT AND STYPE='P' GROUP BY d.DEPT,u.BRAND, u.COLOR, u.STYLE, d.DEPTDESC ORDER BY SUM(c.AMT) DESC

SELECT TOP 100 * FROM SKSTINFO ORDER BY STORE ASC;
SELECT COUNT(STORE) AS num FROM SKSTINFO GROUP BY STORE HAVING COUNT(DISTINCT SKU)>180000;

SELECT DISTINCT * FROM SKUINFO u, DEPTINFO d WHERE u.DEPT=d.DEPT AND d.DEPTDESC='COP' AND u.BRAND='FEDERAL' AND u.COLOR='RINSE WASH'; 

SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT SUM(c.AMT) AS sm, t.STORE, t.CITY, t.STATE FROM TRNSACT c, STRINFO t WHERE c.STORE=t.STORE GROUP BY t.STORE, t.CITY, t.STATE ORDER BY SUM(c.AMT) DESC

SELECT COUNT(state) AS howm, STATE FROM STRINFO GROUP BY STATE  HAVING COUNT(STORE)>10

SELECT DISTINCT u.SKU, t.RETAIL, d.DEPTDESC FROM SKUINFO u, SKSTINFO t, DEPTINFO d WHERE t.SKU=u.SKU AND u.DEPT=d.DEPT AND u.BRAND='SKECHERS' AND u.COLOR='WHT/SAPHIRE' AND d.DEPTDESC='REEBOK'

Week 5 practce

SELECT COUNT(DISTINCT SALEDATE) AS datenum, EXTRACT(MONTH from SALEDATE) AS monnum, EXTRACT (YEAR from SALEDATE) AS yearnum FROM TRNSACT GROUP BY EXTRACT(MONTH from SALEDATE), EXTRACT (YEAR from SALEDATE) ORDER BY EXTRACT(MONTH from SALEDATE), EXTRACT (YEAR from SALEDATE)

EXERCISE 2

SUM(2,3)

SELECT SKU, SUM(CASE WHEN EXTRACT(MONTH from SALEDATE)=6 THEN AMT END) AS junevalues FROM TRNSACT WHERE STYPE='p' GROUP BY SKU;
SELECT SKU, SUM(CASE WHEN EXTRACT(MONTH from SALEDATE)=7 THEN AMT END) AS julyvalues FROM TRNSACT WHERE STYPE='p' GROUP BY SKU;
SELECT SKU, SUM(CASE WHEN EXTRACT(MONTH from SALEDATE)=8 THEN AMT END) AS Augustvalues FROM TRNSACT WHERE STYPE='p' GROUP BY SKU;

SELECT SKU, SUM(CASE EXTRACT(MONTH from SALEDATE) WHEN 6 THEN AMT WHEN 7 THEN AMT WHEN 8 THEN AMT END) AS summersales FROM TRNSACT WHERE STYPE='p' GROUP BY SKU ORDER BY summersales DESC;

SELECT COUNT(DISTINCT SALEDATE), EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE), STORE FROM TRNSACT GROUP BY EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE),STORE ORDER BY COUNT(DISTINCT SALEDATE)ASC;

SELECT COUNT(DISTINCT SALEDATE), EXTRACT(YEAR from SALEDATE)||EXTRACT(MONTH from SALEDATE)AS comb, STORE FROM TRNSACT WHERE comb NOT LIKE '%2005%8%' GROUP BY comb,STORE ORDER BY COUNT(DISTINCT SALEDATE)ASC;

OR YOU HAVE TO USE TRIM() FUNCTION TO SORT THIS SHIT OUT

EXERCISE 4.

SELECT (SUM(AMT)/COUNT(DISTINCT SALEDATE)) AS dailyave,COUNT(DISTINCT SALEDATE)AS days, EXTRACT(YEAR from SALEDATE)AS yr, EXTRACT(MONTH from SALEDATE)AS mo, STORE, CASE WHEN (yr='2005' AND mo='8') THEN 'kill' ELSE 'stay' END AS remove FROM TRNSACT WHERE STYPE='P' AND remove='stay' GROUP BY EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE),STORE  HAVING days>=20 ORDER BY STORE ASC;


SELECT (SUM(AMT)/COUNT(DISTINCT SALEDATE)) AS dailyave,COUNT(DISTINCT SALEDATE)AS days, EXTRACT(YEAR from SALEDATE)AS yr, EXTRACT(MONTH from SALEDATE)AS mo, STORE, CASE WHEN (yr='2005' AND mo='8') THEN 'kill' ELSE 'stay' END AS remove FROM TRNSACT WHERE STYPE='P' AND remove='stay' GROUP BY EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE),STORE  HAVING days>=20 ORDER BY STORE ASC;

SELECT (SUM(AMT)/COUNT(DISTINCT SALEDATE)) AS dailyave,COUNT(DISTINCT SALEDATE)AS days, EXTRACT(YEAR from SALEDATE)AS yr, EXTRACT(MONTH from SALEDATE)AS mo, STORE, CASE WHEN (yr='2005' AND mo='8') THEN 'kill' ELSE 'stay' END AS remove FROM TRNSACT WHERE STYPE='P' AND remove='stay' GROUP BY EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE),STORE  HAVING days>=20 ORDER BY STORE ASC;

SELECT (SUM(t.AMT)/ccc.days) AS dailyave, ccc.days, ccc.mo, ccc.STORE, CCC.yr, CASE WHEN (ccc.yr='2005' AND ccc.mo='8') THEN 'kill' ELSE 'stay' END AS remove FROM (SELECT COUNT(DISTINCT SALEDATE)AS days, STORE, EXTRACT(YEAR from SALEDATE)AS yr, EXTRACT(MONTH from SALEDATE)AS mo FROM TRNSACT WHERE STYPE='P' GROUP BY EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE),STORE  HAVING days>=20) AS ccc JOIN TRNSACT t ON ccc.STORE=t.STORE WHERE remove='stay' GROUP BY ccc.days, ccc.mo, ccc.store, ccc.yr ORDER BY dailyave



EXERCISe 5:
SELECT CASE  WHEN MSA_HIGH>=50 AND MSA_HIGH<=60 THEN 'low' WHEN MSA_HIGH>60 AND MSA_HIGH<=70 THEN 'medium' WHEN MSA_HIGH>70 THEN 'high' END AS cate, STORE  FROM STORE_MSA;


SELECT a.cate, (SUM(b.dailyave)/SUM(b.days)) AS income FROM (SELECT CASE  WHEN MSA_HIGH>=50 AND MSA_HIGH<=60 THEN 'low' WHEN MSA_HIGH>60 AND MSA_HIGH<=70 THEN 'medium' WHEN MSA_HIGH>70 THEN 'high' END AS cate, STORE  FROM STORE_MSA) AS a JOIN (SELECT SUM(AMT) AS dailyave, COUNT(DISTINCT SALEDATE) AS days, EXTRACT(YEAR from SALEDATE) AS yr, EXTRACT(MONTH from SALEDATE)AS mo, STORE, CASE WHEN (yr='2005' AND mo='8') THEN 'kill' ELSE 'stay' END AS remove FROM TRNSACT WHERE STYPE='P' AND remove='stay' GROUP BY EXTRACT(YEAR from SALEDATE), EXTRACT(MONTH from SALEDATE), STORE  HAVING days>=20) AS b ON a.STORE=b.STORE GROUP BY a.cate
DATABASE UA_DILLARDS
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, SKSTINFO t WHERE u.SKU=t.SKU;
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, TRNSACT c WHERE u.SKU=c.SKU;
SELECT COUNT(DISTINCT t.SKU) AS num FROM TRNSACT c, SKSTINFO t WHERE c.SKU=t.SKU;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN TRNSACT c ON u.SKU=c.SKU WHERE u.SKU IS NOT NULL AND c.SKU IS NULL;
SELECT DISTINCT(t.SKU) AS uni FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT COUNT(*) AS times, t.SKU, t.STORE FROM SKSTINFO t, TRNSACT c WHERE t.SKU=c.SKU AND t.STORE=c.STORE GROUP BY t.STORE, t.SKU;

SELECT COUNT(DISTINCT STORE) AS num FROM STRINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM STORE_MSA;
SELECT COUNT(DISTINCT STORE) AS num FROM SKSTINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM TRNSACT;



SELECT s.STORE AS uni FROM ((STRINFO s LEFT JOIN STORE_MSA m ON s.STORE=m.STORE) LEFT JOIN SKSTINFO t ON m.STORE=t.STORE) LEFT JOIN TRNSACT c ON t.STORE=c.STORE WHERE s.STORE IS NOT NULL AND c.STORE IS NULL AND m.STORE IS NULL AND t.STORE IS NULL;

SELECT DISTINCT(c.STORE) comm FROM TRNSACT c, STORE_MSA m WHERE c.STORE=m.STORE AND c.STORE IS NOT NULL 

SELECT * FROM STORE_MSA WHERE STORE='307';
SELECT * FROM SKSTINFO WHERE STORE='307';
SELECT * FROM STRINFO WHERE STORE='307';


SELECT * FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT * FROM SKSTINFO WHERE SKU='9614895';

SELECT TOP 10(ORGPRICE/SPRICE), ORGPRICE, SPRICE AS test FROM TRNSACT; 

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P' AND REGISTER='640';



SELECT TOP 100  s.SKU FROM SKSTINFO s, TRNSACT t WHERE s.SKU=t.SKU AND s.SKU IS NOT NULL

SELECT  TOP 100 * FROM TRNSACT;
SELECT  * FROM SKSTINFO WHERE SKU='1816674';
SELECT * FROM SKUINFO WHERE SKU='1816674';


SELECT * FROM TRNSACT WHERE STYPE='R' ORDER BY AMT DESC;  (RESULT 2001-12-31)
SELECT TOP 10 * FROM TRNSACT WHERE STYPE='R' ORDER BY QUANTITY DESC; (050729, 90)

SELECT TOP 10 (AMT/QUANTITY) AS maxprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY maxprice DESC;
SELECT TOP 10 (AMT/QUANTITY) AS minprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY minprice ASC;

SELECT TOP 1 * FROM SKUINFO;
SELECT TOP 1 * FROM DEPTINFO;


SELECT COUNT(DISTINCT s.BRAND) AS num, d.DEPT, d.DEPTDESC FROM SKUINFO s, DEPTINFO d WHERE s.DEPT=d.DEPT GROUP BY d.DEPT, d.DEPTDESC HAVING COUNT(DISTINCT s.BRAND)>100;

SELECT TOP 1 * FROM SKSTINFO;           s
SELECT TOP 1 * FROM SKUINFO;            u  
SELECT TOP 1 * FROM DEPTINFO;           d

SELECT u.SKU, (d.DEPTDESC) AS Description FROM SKSTINFO s, SKUINFO u, DEPTINFO d WHERE s.SKU=u.SKU AND u.DEPT=d.DEPT AND u.SKU='5020024';

SELECT TOP 1 * FROM TRNSACT;            c

SELECT d.DEPT, d.DEPTDESC, SUM(AMT) AS maxreturn, u.BRAND, u.STYLE, u.COLOR FROM TRNSACT c, DEPTINFO d, SKUINFO u WHERE c.SKU=u.SKU AND u.DEPT=d.DEPT AND STYPE='R' GROUP BY d.DEPT, d.DEPTDESC, u.BRAND, u.STYLE, u.COLOR ORDER BY SUM(AMT) DESC;

SELECT TOP 1 * FROM STRINFO;            t

SELECT SUM(c.AMT) AS revenu, t.STORE, t.STATE, t.ZIP, t.CITY FROM TRNSACT c, STRINFO t WHERE t.STORE=c.STORE AND c.STYPE='P' GROUP BY t.STORE, t.STATE, t.ZIP, t.CITY ORDER BY SUM(c.AMT) DESC;

SELECT SUM(AMT) AS inc, SALEDATE FROM TRNSACT WHERE STYPE='P' GROUP BY SALEDATE ORDER BY SUM(AMT) DESC;

SELECT COUNT(DISTINCT u.SKU) AS num, d.DEPTDESC FROM SKUINFO u, DEPTINFO d WHERE u.DEPT=d.DEPT GROUP BY d.DEPTDESC ORDER BY COUNT(DISTINCT u.SKU) DESC

SELECT COUNT(DISTINCT SKU) as num FROM TRNSACT;
SELECT COUNT(DISTINCT SKU) as num FROM SKUINFO;
SELECT COUNT(DISTINCT SKU) as num FROM SKSTINFO

SELECT COUNT(DISTINCT s.SKU) AS num FROM SKUINFO u RIGHT JOIN SKSTINFO s ON s.SKU=u.SKU WHERE s.SKU IS NOT NULL AND u.SKU IS NULL

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P';

SELECT  * FROM STORE_MSA WHERE STATE='NC';
SELECT COUNT(MSA) AS num, MSA_POP, MSA_INCOME FROM STORE_MSA WHERE STATE='NC' GROUP BY MSA_POP, MSA_INCOME ORDER BY MSA_POP ASC, MSA_INCOME DESC;

SELECT SUM(c.AMT) AS saleamt, d.DEPT,u.BRAND, u.STYLE, u.COLOR, d.DEPTDESC FROM DEPTINFO d, TRNSACT c,  SKUINFO u WHERE u.SKU=c.SKU AND d.DEPT=u.DEPT AND STYPE='P' GROUP BY d.DEPT,u.BRAND, u.COLOR, u.STYLE, d.DEPTDESC ORDER BY SUM(c.AMT) DESC

SELECT TOP 100 * FROM SKSTINFO ORDER BY STORE ASC;
SELECT COUNT(STORE) AS num FROM SKSTINFO GROUP BY STORE HAVING COUNT(DISTINCT SKU)>180000;

SELECT DISTINCT * FROM SKUINFO u, DEPTINFO d WHERE u.DEPT=d.DEPT AND d.DEPTDESC='COP' AND u.BRAND='FEDERAL' AND u.COLOR='RINSE WASH'; 

SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT SUM(c.AMT) AS sm, t.STORE, t.CITY, t.STATE FROM TRNSACT c, STRINFO t WHERE c.STORE=t.STORE GROUP BY t.STORE, t.CITY, t.STATE ORDER BY SUM(c.AMT) DESC

SELECT COUNT(state) AS howm, STATE FROM STRINFO GROUP BY STATE  HAVING COUNT(STORE)>10

SELECT DISTINCT u.SKU, t.RETAIL, d.DEPTDESC FROM SKUINFO u, SKSTINFO t, DEPTINFO d WHERE t.SKU=u.SKU AND u.DEPT=d.DEPT AND u.BRAND='SKECHERS' AND u.COLOR='WHT/SAPHIRE' AND d.DEPTDESC='REEBOK'
DATABASE UA_DILLARDS
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, SKSTINFO t WHERE u.SKU=t.SKU;
SELECT COUNT(DISTINCT u.SKU) AS num FROM SKUINFO u, TRNSACT c WHERE u.SKU=c.SKU;
SELECT COUNT(DISTINCT t.SKU) AS num FROM TRNSACT c, SKSTINFO t WHERE c.SKU=t.SKU;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN SKSTINFO t ON u.SKU=t.SKU WHERE u.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT DISTINCT(u.SKU) AS uni FROM SKUINFO u LEFT JOIN TRNSACT c ON u.SKU=c.SKU WHERE u.SKU IS NOT NULL AND c.SKU IS NULL;
SELECT DISTINCT(t.SKU) AS uni FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;

SELECT COUNT(*) AS times, t.SKU, t.STORE FROM SKSTINFO t, TRNSACT c WHERE t.SKU=c.SKU AND t.STORE=c.STORE GROUP BY t.STORE, t.SKU;

SELECT COUNT(DISTINCT STORE) AS num FROM STRINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM STORE_MSA;
SELECT COUNT(DISTINCT STORE) AS num FROM SKSTINFO;
SELECT COUNT(DISTINCT STORE) AS num FROM TRNSACT;



SELECT s.STORE AS uni FROM ((STRINFO s LEFT JOIN STORE_MSA m ON s.STORE=m.STORE) LEFT JOIN SKSTINFO t ON m.STORE=t.STORE) LEFT JOIN TRNSACT c ON t.STORE=c.STORE WHERE s.STORE IS NOT NULL AND c.STORE IS NULL AND m.STORE IS NULL AND t.STORE IS NULL;

SELECT DISTINCT(c.STORE) comm FROM TRNSACT c, STORE_MSA m WHERE c.STORE=m.STORE AND c.STORE IS NOT NULL 

SELECT * FROM STORE_MSA WHERE STORE='307';
SELECT * FROM SKSTINFO WHERE STORE='307';
SELECT * FROM STRINFO WHERE STORE='307';


SELECT * FROM TRNSACT c LEFT JOIN SKSTINFO t ON c.SKU=t.SKU WHERE c.SKU IS NOT NULL AND t.SKU IS NULL;
SELECT * FROM SKSTINFO WHERE SKU='9614895';

SELECT TOP 10(ORGPRICE/SPRICE), ORGPRICE, SPRICE AS test FROM TRNSACT; 

SELECT ((SUM(c.AMT)-(SUM(c.QUANTITY*t.COST)))/COUNT(DISTINCT c.SALEDATE)) AS dailyp FROM SKSTINFO t, TRNSACT c WHERE c.SKU=t.SKU AND t.STORE=c.STORE AND c.STYPE='P' AND REGISTER='640';



SELECT TOP 100  s.SKU FROM SKSTINFO s, TRNSACT t WHERE s.SKU=t.SKU AND s.SKU IS NOT NULL

SELECT  TOP 100 * FROM TRNSACT;
SELECT  * FROM SKSTINFO WHERE SKU='1816674';
SELECT * FROM SKUINFO WHERE SKU='1816674';


SELECT * FROM TRNSACT WHERE STYPE='R' ORDER BY AMT DESC;  (RESULT 2001-12-31)
SELECT TOP 10 * FROM TRNSACT WHERE STYPE='R' ORDER BY QUANTITY DESC; (050729, 90)

SELECT TOP 10 (AMT/QUANTITY) AS maxprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY maxprice DESC;
SELECT TOP 10 (AMT/QUANTITY) AS minprice, SKU, AMT, SPRICE, QUANTITY  FROM TRNSACT WHERE STYPE='P' ORDER BY minprice ASC;

SELECT TOP 1 * FROM SKUINFO;
SELECT TOP 1 * FROM DEPTINFO;


SELECT COUNT(DISTINCT s.BRAND) AS num, d.DEPT, d.DEPTDESC FROM SKUINFO s, DEPTINFO d WHERE s.DEPT=d.DEPT GROUP BY d.DEPT, d.DEPTDESC HAVING COUNT(DISTINCT s.BRAND)>100;

SELECT TOP 1 * FROM SKSTINFO;           s
SELECT TOP 1 * FROM SKUINFO;            u  
SELECT TOP 1 * FROM DEPTINFO;           d

SELECT u.SKU, (d.DEPTDESC) AS Description FROM SKSTINFO s, SKUINFO u, DEPTINFO d WHERE s.SKU=u.SKU AND u.DEPT=d.DEPT AND u.SKU='5020024';

SELECT TOP 1 * FROM TRNSACT;            c

SELECT d.DEPT, d.DEPTDESC, SUM(AMT) AS maxreturn, u.BRAND, u.STYLE, u.COLOR FROM TRNSACT c, DEPTINFO d, SKUINFO u WHERE c.SKU=u.SKU AND u.DEPT=d.DEPT AND STYPE='R' GROUP BY d.DEPT, d.DEPTDESC, u.BRAND, u.STYLE, u.COLOR ORDER BY SUM(AMT) DESC;

SELECT TOP 1 * FROM STRINFO;            t

SELECT SUM(c.AMT) AS revenu, t.STORE, t.STATE, t.ZIP, t.CITY FROM TRNSACT c, STRINFO t WHERE t.STORE=c.STORE AND c.STYPE='P' GROUP BY t.STORE, t.STATE, t.ZIP, t.CITY ORDER BY SUM(c.AMT) DESC;
